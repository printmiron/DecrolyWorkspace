
DELETE 
FROM homenaje 
WHERE emp_no = '10001';

UPDATE homenaje
SET lugar = 'Santander'
WHERE current_date BETWEEN from_date AND to_date;



SELECT e.first_name, e.last_name
FROM dept_emp de
JOIN employers e ON de.emp_no = dm.emp_no
WHERE current_date BETWEEN dm.from_date AND dm.to_date;




SELECT e.first_name, e.last_name, s.salary
FROM employees e
JOIN dept_manager dm ON e.emp_no = dm.emp_no
JOIN salaries s ON e.emp_no = s.emp_no
WHERE current_date BETWEEN s.from_date AND s.to_date;




SELECT AVG(s.salary) AS avg_salary
FROM employees e
JOIN titles t ON e.emp_no = t.emp_no
JOIN salaries s ON e.emp_no = s.emp_no
WHERE current_date BETWEEN s.from_date AND s.to_date
AND current_date BETWEEN t.from_date AND t.to_date
;














SELECT e.first_name, e.last_name, COUNT(DISTINCT de.dept_no) AS num_departamentos
FROM employees e
JOIN dept_emp de ON e.emp_no = de.emp_no
GROUP BY e.emp_no
HAVING num_departamentos > 0;

-- 1
SELECT e.first_name, e.last_name , e.hire_date
FROM employees e
JOIN homenaje h ON e.emp_no = h.emp_no
where current_date between h.from_date and h.to_date;


-- 2
SELECT e.first_name, e.last_name, s.salary
FROM employees e
JOIN dept_emp de ON e.emp_no = de.demp_no
JOIN dept_manager dm ON de.emp_no = dm.emp_no
JOIN salaries s ON de.emp_no = s.emp_no 
where current_date between dm.from_date and dm.to_date;

-- 3

select e.first_name, e.last_name, s.salary
from employees e
join salaries s on e.emp_no = s.emp_no
where current_date between s.from_date and s.to_date;


-- 4



-- 5

SELECT e.first_name, e.last_name, COUNT(DISTINCT de.dept_no) AS num_departamentos
FROM employees e
JOIN dept_emp de ON e.emp_no = de.emp_no
GROUP BY e.emp_no
HAVING num_departamentos > 0;